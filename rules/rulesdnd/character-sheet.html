<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø—É—Ç—å –∫ CSS, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–æ–¥–ø–∞–ø–∫–µ rules -->
  <link rel="stylesheet" href="../../style.css" />
  <title>üßæ –õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</title>
  <style>
    /* –î–æ–±–∞–≤–∏–º —Å—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –±–æ–Ω—É—Å–æ–≤ —Ä–∞—Å—ã –ø—Ä—è–º–æ —Å—é–¥–∞ */
    .info-box {
      background-color: #5a3b26;
      border-left: 4px solid #d4af37;
      padding: 10px;
      margin-top: 10px;
      border-radius: 4px;
      font-size: 0.95em;
    }

    .info-box h4 {
      margin-top: 0;
      color: #d4af37;
      font-size: 1.1em;
    }

    .info-box ul {
      margin: 5px 0;
      padding-left: 20px;
    }

    .info-box li {
      margin-bottom: 3px;
    }

    /* –î–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ—Ç–∫–∏ —Ñ–æ—Ä–º */
    .inline-group {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }

    .inline-group > label {
      flex: 1;
      min-width: 150px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 15px 0;
    }

    .combat-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 15px 0;
    }

    .skills-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* 2 –∫–æ–ª–æ–Ω–∫–∏ */
        gap: 8px;
        margin-top: 10px;
    }

    .skills-grid label {
        display: flex;
        align-items: center;
        font-weight: normal;
        margin-bottom: 0;
        font-size: 0.95em;
    }

    .skills-grid input[type="checkbox"] {
        margin-right: 8px; /* –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É —á–µ–∫–±–æ–∫—Å–æ–º –∏ —Ç–µ–∫—Å—Ç–æ–º */
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */
    .sheet-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin: 20px 0;
    }

    @media (max-width: 900px) {
      .sheet-layout {
        grid-template-columns: 1fr;
      }
    }

    .sheet-form h2,
    .sheet-preview h2 {
      color: #d4af37;
      margin-bottom: 15px;
      border-left: 5px solid #d4af37;
      padding-left: 10px;
    }

    .sheet-form label {
      display: block;
      margin-bottom: 12px;
      font-weight: bold;
    }

    .sheet-form input,
    .sheet-form select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #8b6f47;
      background: #4a2f1a;
      color: #e0ccb6;
      font-size: 1em;
      box-sizing: border-box; /* –£—á–∏—Ç—ã–≤–∞–µ–º padding –∏ border –≤ —à–∏—Ä–∏–Ω–µ */
    }

    .sheet-form input:focus,
    .sheet-form select:focus {
      outline: none;
      border-color: #d4af37;
      box-shadow: 0 0 8px rgba(212, 175, 55, 0.4);
    }


    .form-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    /* === –ö–ê–†–¢–û–ß–ö–ê –ü–ï–†–°–û–ù–ê–ñ–ê (–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä) === */
    .char-card {
      background: linear-gradient(145deg, #5a3b26, #4a2e1a);
      border: 2px solid #8b6f47;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 6px 0 #3a2410, 0 6px 15px rgba(0, 0, 0, 0.5);
      font-size: 0.95em; /* –ù–µ–º–Ω–æ–≥–æ —É–º–µ–Ω—å—à–∏–º —à—Ä–∏—Ñ—Ç –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–º–µ—â–µ–Ω–∏—è */
    }

    .char-header h3 {
      font-size: 1.6em;
      color: #f0d98f;
      margin-bottom: 10px;
      text-align: center;
    }

    .char-header p {
      margin: 5px 0;
      text-align: center;
    }

    /* –°—Ç–∞—Ç—ã –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–µ */
    .char-stats-preview h4,
    .char-combat-preview h4,
    .char-saves-skills-preview h4 {
        color: #d4af37;
        border-bottom: 1px solid #8b6f47;
        padding-bottom: 5px;
        margin-top: 20px;
        margin-bottom: 10px;
    }

    .char-stats-preview table {
        width: 100%;
        border-collapse: collapse;
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 6px;
        overflow: hidden;
    }

    .char-stats-preview th,
    .char-stats-preview td {
        padding: 8px;
        text-align: center;
        border: 1px solid #5a3b26;
    }

    .char-stats-preview th {
        background-color: #5a3b26;
        color: #d4af37;
    }

    /* –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ –∏ –Ω–∞–≤—ã–∫–∏ –≤ –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏ */
    .saves-skills-columns {
        display: flex;
        gap: 20px;
    }

    .saves-skills-columns > div {
        flex: 1;
    }

    .saves-skills-columns h5 {
        color: #f0d98f;
        margin-bottom: 8px;
    }

    .saves-skills-columns ul {
        list-style-type: none;
        padding-left: 0;
        margin-top: 0;
    }

    .saves-skills-columns li {
        margin-bottom: 5px;
        padding: 3px 0;
        border-bottom: 1px dotted #5a3b26;
    }

    @media (max-width: 768px) {
        .saves-skills-columns {
            flex-direction: column;
        }
        .skills-grid {
            grid-template-columns: 1fr; /* 1 –∫–æ–ª–æ–Ω–∫–∞ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
        }
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üßæ –õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h1>
      <p>–°–æ–∑–¥–∞–π —Å–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º D&D 5e</p>
    </header>

    <nav>
      <a href="../index.html" class="btn-back"> <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø—É—Ç—å –Ω–∞–∑–∞–¥ -->
        <span class="arrow">‚Üê</span>
        <span class="text">–í –º–µ–Ω—é</span>
      </a>
    </nav>

    <main class="sheet-layout">
      <!-- –§–æ—Ä–º–∞ -->
      <section class="sheet-form">
        <h2>üìù –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>

        <label>
          –ò–º—è:
          <input type="text" id="char-name" placeholder="–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞" />
        </label>

        <div class="inline-group">
          <label>
            –†–∞—Å–∞:
            <select id="char-race">
              <!-- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞—Å—ã –∏–∑ PHB -->
              <option value="human">–ß–µ–ª–æ–≤–µ–∫ (PHB)</option>
              <option value="elf">–≠–ª—å—Ñ (PHB)</option>
              <option value="high-elf">–í—ã—Å—à–∏–π —ç–ª—å—Ñ (PHB)</option>
              <option value="wood-elf">–õ–µ—Å–Ω–æ–π —ç–ª—å—Ñ (PHB)</option>
              <option value="dark-elf">–¢—ë–º–Ω—ã–π —ç–ª—å—Ñ (–î—Ä–æ—É) (PHB)</option>
              <option value="dwarf">–î–≤–∞—Ä—Ñ (PHB)</option>
              <option value="hill-dwarf">–•–æ–ª–º–æ–≤–æ–π –¥–≤–∞—Ä—Ñ (PHB)</option>
              <option value="mountain-dwarf">–ì–æ—Ä–Ω—ã–π –¥–≤–∞—Ä—Ñ (PHB)</option>
              <option value="halfling">–ü–æ–ª—É—Ä–æ—Å–ª–∏–∫ (PHB)</option>
              <option value="lightfoot-halfling">–õ–µ–≥–∫–æ–Ω–æ–≥–∏–π –ø–æ–ª—É—Ä–æ—Å–ª–∏–∫ (PHB)</option>
              <option value="stout-halfling">–ö—Ä–µ–ø–∫–∏–π –ø–æ–ª—É—Ä–æ—Å–ª–∏–∫ (PHB)</option>
              <option value="gnome">–ì–Ω–æ–º (PHB)</option>
              <option value="forest-gnome">–õ–µ—Å–Ω–æ–π –≥–Ω–æ–º (PHB)</option>
              <option value="rock-gnome">–°–∫–∞–ª—å–Ω—ã–π –≥–Ω–æ–º (PHB)</option>
              <option value="half-orc">–ü–æ–ª—É–æ—Ä–∫ (PHB)</option>
              <option value="half-elf">–ü–æ–ª—É—ç–ª—å—Ñ (PHB)</option>
              <option value="tiefling">–¢–∏—Ñ–ª–∏–Ω–≥ (PHB)</option>
              <option value="infernal-tiefling">–ò–Ω—Ñ–µ—Ä–Ω–∞–ª—å–Ω—ã–π —Ç–∏—Ñ–ª–∏–Ω–≥ (PHB)</option>
              <!-- –†–∞—Å—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ -->
              <option value="aarakocra">–ê–∞—Ä–∞–∫–æ–∫—Ä–∞ (AAG)</option>
              <option value="aasimar">–ê–∞—Å–∏–º–∞—Ä (VGtM)</option>
              <option value="protector-aasimar">–ê–∞—Å–∏–º–∞—Ä-–∑–∞—â–∏—Ç–Ω–∏–∫ (VGtM)</option>
              <option value="scourge-aasimar">–ê–∞—Å–∏–º–∞—Ä-–∫–∞—Ä–∞—Ç–µ–ª—å (VGtM)</option>
              <option value="fallen-aasimar">–ü–∞–¥—à–∏–π –∞–∞—Å–∏–º–∞—Ä (VGtM)</option>
              <option value="autognome">–ê–≤—Ç–æ–≥–Ω–æ–º (AAG)</option>
              <option value="bugbear">–ë–∞–≥–±–∏—Ä (VGtM)</option>
              <option value="giff">–ì–∏—Ñ—Ñ (AAG)</option>
              <option value="gith">–ì–∏—Ç (VGtM)</option>
              <option value="githyanki">–ì–∏—Ç—ä—è–Ω–∫–∏ (VGtM)</option>
              <option value="githzerai">–ì–∏—Ç—Ü–µ—Ä–∞–∏ (VGtM)</option>
              <option value="simic-hybrid">–ì–∏–±—Ä–∏–¥ –°–∏–º–∏–∫–æ–≤ (GGR)</option>
              <option value="verdan">–í–µ—Ä–¥–∞–Ω (AcqInc)</option>
              <option value="vedalken">–í–µ–¥–∞–ª–∫–µ–Ω (GGR)</option>
              <!-- –î–æ–±–∞–≤—å –±–æ–ª—å—à–µ —Ä–∞—Å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ -->
            </select>
          </label>

          <label>
            –ö–ª–∞—Å—Å:
            <select id="char-class">
              <option value="–≤–æ–∏–Ω">–í–æ–∏–Ω</option>
              <option value="–º–∞–≥">–ú–∞–≥</option>
              <option value="–∂—Ä–µ—Ü">–ñ—Ä–µ—Ü</option>
              <option value="—Ä–∞–∑–±–æ–π–Ω–∏–∫">–†–∞–∑–±–æ–π–Ω–∏–∫</option>
              <option value="–ø–∞–ª–∞–¥–∏–Ω">–ü–∞–ª–∞–¥–∏–Ω</option>
              <option value="—Å–ª–µ–¥–æ–ø—ã—Ç">–°–ª–µ–¥–æ–ø—ã—Ç</option>
              <option value="–≤–∞—Ä–≤–∞—Ä">–í–∞—Ä–≤–∞—Ä</option>
              <option value="–¥—Ä—É–∏–¥">–î—Ä—É–∏–¥</option>
              <option value="–±–∞—Ä–¥">–ë–∞—Ä–¥</option>
              <option value="—á–∞—Ä–æ–¥–µ–π">–ß–∞—Ä–æ–¥–µ–π</option>
              <option value="–∫–æ–ª–¥—É–Ω">–ö–æ–ª–¥—É–Ω</option>
              <option value="–º–æ–Ω–∞—Ö">–ú–æ–Ω–∞—Ö</option>
            </select>
          </label>

          <label>
            –£—Ä–æ–≤–µ–Ω—å:
            <input type="number" id="char-level" min="1" max="20" value="1" />
          </label>
        </div>

        <label>
          –ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:
          <input type="text" id="char-background" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ—Å—Ç–æ–ª—é–¥–∏–Ω" />
        </label>

        <div class="inline-group">
          <label>
            –ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ:
            <select id="char-alignment">
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π">–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π">–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π</option>
            </select>
          </label>
          <label>
            –û–ø—ã—Ç:
            <input type="number" id="char-exp" value="0" />
          </label>
        </div>

        <!-- –ë–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤ —Ä–∞—Å—ã -->
        <div id="race-bonus-info" class="info-box" style="display:none;">
          <h4>–ë–æ–Ω—É—Å—ã —Ä–∞—Å—ã:</h4>
          <ul id="race-bonuses-list"></ul>
        </div>

        <h3>üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
        <div class="stats-grid">
          <label>–°–∏–ª–∞ (STR): <input type="number" id="str" min="3" max="30" value="10" /></label>
          <label>–õ–æ–≤–∫–æ—Å—Ç—å (DEX): <input type="number" id="dex" min="3" max="30" value="10" /></label>
          <label>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ (CON): <input type="number" id="con" min="3" max="30" value="10" /></label>
          <label>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç (INT): <input type="number" id="int" min="3" max="30" value="10" /></label>
          <label>–ú—É–¥—Ä–æ—Å—Ç—å (WIS): <input type="number" id="wis" min="3" max="30" value="10" /></label>
          <label>–•–∞—Ä–∏–∑–º–∞ (CHA): <input type="number" id="cha" min="3" max="30" value="10" /></label>
        </div>

        <h3>üõ°Ô∏è –ë–æ–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
        <div class="combat-grid">
          <label>–ö–æ—Å—Ç—å –•–∏—Ç–æ–≤ (HD): <input type="text" id="hit-die" placeholder="1–∫10" /></label>
          <label>–•–∏—Ç—ã (HP): <input type="number" id="current-hp" placeholder="–¢–µ–∫—É—â–∏–µ" /></label>
          <label>–ú–∞–∫—Å. –•–∏—Ç—ã: <input type="number" id="max-hp" placeholder="–ú–∞–∫—Å–∏–º—É–º" /></label>
          <label>–ö–î (–±–µ–∑ –¥–æ—Å–ø–µ—Ö–∞): <span id="calculated-ac">10</span></label>
          <label>–ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (—Ñ—É—Ç—ã): <input type="number" id="base-speed" value="30" /></label>
          <label>–°–∫–æ—Ä–æ—Å—Ç—å (—Ñ—É—Ç—ã): <span id="calculated-speed">30</span></label>
          <label>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞: <span id="calculated-init">+0</span></label>
        </div>

        <h3>üéØ –ù–∞–≤—ã–∫–∏</h3>
        <div class="skills-grid">
          <label><input type="checkbox" id="skill-acrobatics"> –ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞ (DEX)</label>
          <label><input type="checkbox" id="skill-animal-handling"> –£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏ (WIS)</label>
          <label><input type="checkbox" id="skill-arcana"> –ú–∞–≥–∏—è (INT)</label>
          <label><input type="checkbox" id="skill-athletics"> –ê—Ç–ª–µ—Ç–∏–∫–∞ (STR)</label>
          <label><input type="checkbox" id="skill-deception"> –û–±–º–∞–Ω (CHA)</label>
          <label><input type="checkbox" id="skill-history"> –ò—Å—Ç–æ—Ä–∏—è (INT)</label>
          <label><input type="checkbox" id="skill-insight"> –ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (WIS)</label>
          <label><input type="checkbox" id="skill-intimidation"> –ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ (CHA)</label>
          <label><input type="checkbox" id="skill-investigation"> –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (INT)</label>
          <label><input type="checkbox" id="skill-medicine"> –ú–µ–¥–∏—Ü–∏–Ω–∞ (WIS)</label>
          <label><input type="checkbox" id="skill-nature"> –ü—Ä–∏—Ä–æ–¥–∞ (INT)</label>
          <label><input type="checkbox" id="skill-perception"> –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ (WIS)</label>
          <label><input type="checkbox" id="skill-performance"> –í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ (CHA)</label>
          <label><input type="checkbox" id="skill-persuasion"> –£–±–µ–∂–¥–µ–Ω–∏–µ (CHA)</label>
          <label><input type="checkbox" id="skill-religion"> –†–µ–ª–∏–≥–∏—è (INT)</label>
          <label><input type="checkbox" id="skill-sleight-of-hand"> –õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫ (DEX)</label>
          <label><input type="checkbox" id="skill-stealth"> –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å (DEX)</label>
          <label><input type="checkbox" id="skill-survival"> –í—ã–∂–∏–≤–∞–Ω–∏–µ (WIS)</label>
        </div>

        <div class="form-buttons">
          <button id="save-char" class="btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button id="export-char" class="btn-secondary">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
          <button id="reset-char" class="btn-clear">üóëÔ∏è –°–±—Ä–æ—Å</button>
        </div>
      </section>

      <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
      <section class="sheet-preview">
        <h2>üé≠ –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–∂</h2>
        <div class="char-card">
          <div class="char-header">
            <h3 id="preview-name">–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>
            <p><strong>–†–∞—Å–∞:</strong> <span id="preview-race">—á–µ–ª–æ–≤–µ–∫</span> |
            <strong>–ö–ª–∞—Å—Å:</strong> <span id="preview-class">–≤–æ–∏–Ω</span> |
            <strong>–£—Ä–æ–≤–µ–Ω—å:</strong> <span id="preview-level">1</span></p>
            <p><strong>–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:</strong> <span id="preview-bg">-</span> |
            <strong>–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ:</strong> <span id="preview-align">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</span></p>
          </div>

          <div class="char-stats-preview">
            <h4>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
            <table>
              <thead>
                <tr>
                  <th>–•–ê–†</th>
                  <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                  <th>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä</th>
                  <th>–ü–∞—Å—Å–∏–≤–Ω–æ–µ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>–°–∏–ª–∞</td>
                  <td id="preview-str-val">10</td>
                  <td id="preview-str-mod">+0</td>
                  <td>-</td>
                </tr>
                <tr>
                  <td>–õ–æ–≤–∫–æ—Å—Ç—å</td>
                  <td id="preview-dex-val">10</td>
                  <td id="preview-dex-mod">+0</td>
                  <td id="preview-pass-dex">10</td>
                </tr>
                <tr>
                  <td>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ</td>
                  <td id="preview-con-val">10</td>
                  <td id="preview-con-mod">+0</td>
                  <td>-</td>
                </tr>
                <tr>
                  <td>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç</td>
                  <td id="preview-int-val">10</td>
                  <td id="preview-int-mod">+0</td>
                  <td>-</td>
                </tr>
                <tr>
                  <td>–ú—É–¥—Ä–æ—Å—Ç—å</td>
                  <td id="preview-wis-val">10</td>
                  <td id="preview-wis-mod">+0</td>
                  <td id="preview-pass-wis">10</td>
                </tr>
                <tr>
                  <td>–•–∞—Ä–∏–∑–º–∞</td>
                  <td id="preview-cha-val">10</td>
                  <td id="preview-cha-mod">+0</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="char-combat-preview">
            <h4>–ë–æ–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h4>
            <p><strong>–ö–î:</strong> <span id="preview-ac">10</span> |
            <strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> <span id="preview-speed">30</span> —Ñ—É—Ç–æ–≤ |
            <strong>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞:</strong> <span id="preview-init">+0</span></p>
            <p><strong>–•–∏—Ç—ã:</strong> <span id="preview-hp">0</span> / <span id="preview-max-hp">0</span> |
            <strong>–ö–æ—Å—Ç—å –•–∏—Ç–æ–≤:</strong> <span id="preview-hd">-</span></p>
          </div>

          <div class="char-saves-skills-preview">
            <h4>–°–ø–∞—Å–±—Ä–æ—Å–∫–∏ & –ù–∞–≤—ã–∫–∏</h4>
            <div class="saves-skills-columns">
                <div>
                    <h5>–°–ø–∞—Å–±—Ä–æ—Å–∫–∏</h5>
                    <ul id="preview-saves">
                        <li>–°–∏–ª–∞: +0</li>
                        <li>–õ–æ–≤–∫–æ—Å—Ç—å: +0</li>
                        <li>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ: +0</li>
                        <li>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: +0</li>
                        <li>–ú—É–¥—Ä–æ—Å—Ç—å: +0</li>
                        <li>–•–∞—Ä–∏–∑–º–∞: +0</li>
                    </ul>
                </div>
                <div>
                    <h5>–ù–∞–≤—ã–∫–∏ (—Å –±–æ–Ω—É—Å–æ–º –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞)</h5>
                    <ul id="preview-skills">
                        <li>–ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞: +0</li>
                        <li>–£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏: +0</li>
                        <li>–ú–∞–≥–∏—è: +0</li>
                        <li>–ê—Ç–ª–µ—Ç–∏–∫–∞: +0</li>
                        <li>–û–±–º–∞–Ω: +0</li>
                        <li>–ò—Å—Ç–æ—Ä–∏—è: +0</li>
                        <li>–ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: +0</li>
                        <li>–ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ: +0</li>
                        <li>–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: +0</li>
                        <li>–ú–µ–¥–∏—Ü–∏–Ω–∞: +0</li>
                        <li>–ü—Ä–∏—Ä–æ–¥–∞: +0</li>
                        <li>–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: +0</li>
                        <li>–í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ: +0</li>
                        <li>–£–±–µ–∂–¥–µ–Ω–∏–µ: +0</li>
                        <li>–†–µ–ª–∏–≥–∏—è: +0</li>
                        <li>–õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫: +0</li>
                        <li>–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å: +0</li>
                        <li>–í—ã–∂–∏–≤–∞–Ω–∏–µ: +0</li>
                    </ul>
                </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p>–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–ª—è D&D 5e</p>
    </footer>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
        // --- –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã ---
        const nameInput = document.getElementById("char-name");
        const raceSelect = document.getElementById("char-race");
        const classSelect = document.getElementById("char-class");
        const levelInput = document.getElementById("char-level");
        const bgInput = document.getElementById("char-background");
        const alignSelect = document.getElementById("char-alignment");
        const expInput = document.getElementById("char-exp");

        const statsInputs = {
            str: document.getElementById("str"),
            dex: document.getElementById("dex"),
            con: document.getElementById("con"),
            int: document.getElementById("int"),
            wis: document.getElementById("wis"),
            cha: document.getElementById("cha")
        };

        const hitDieInput = document.getElementById("hit-die");
        const currentHpInput = document.getElementById("current-hp");
        const maxHpInput = document.getElementById("max-hp");
        const baseSpeedInput = document.getElementById("base-speed");

        const skillCheckboxes = {};
        document.querySelectorAll('.skills-grid input[type="checkbox"]').forEach(cb => {
            skillCheckboxes[cb.id.replace('skill-', '')] = cb;
        });

        const saveBtn = document.getElementById("save-char");
        const exportBtn = document.getElementById("export-char");
        const resetBtn = document.getElementById("reset-char");

        // --- –≠–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ ---
        const preview = {
            name: document.getElementById("preview-name"),
            race: document.getElementById("preview-race"),
            class: document.getElementById("preview-class"),
            level: document.getElementById("preview-level"),
            bg: document.getElementById("preview-bg"),
            align: document.getElementById("preview-align"),
            // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
            strVal: document.getElementById("preview-str-val"),
            dexVal: document.getElementById("preview-dex-val"),
            conVal: document.getElementById("preview-con-val"),
            intVal: document.getElementById("preview-int-val"),
            wisVal: document.getElementById("preview-wis-val"),
            chaVal: document.getElementById("preview-cha-val"),
            strMod: document.getElementById("preview-str-mod"),
            dexMod: document.getElementById("preview-dex-mod"),
            conMod: document.getElementById("preview-con-mod"),
            intMod: document.getElementById("preview-int-mod"),
            wisMod: document.getElementById("preview-wis-mod"),
            chaMod: document.getElementById("preview-cha-mod"),
            passDex: document.getElementById("preview-pass-dex"),
            passWis: document.getElementById("preview-pass-wis"),
            // –ë–æ–µ–≤—ã–µ
            ac: document.getElementById("preview-ac"),
            speed: document.getElementById("preview-speed"),
            init: document.getElementById("preview-init"),
            hp: document.getElementById("preview-hp"),
            maxHp: document.getElementById("preview-max-hp"),
            hd: document.getElementById("preview-hd"),
            // –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ –∏ –Ω–∞–≤—ã–∫–∏
            savesList: document.getElementById("preview-saves"),
            skillsList: document.getElementById("preview-skills")
        };

        // --- –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è ---
        const calculatedAc = document.getElementById("calculated-ac");
        const calculatedSpeed = document.getElementById("calculated-speed");
        const calculatedInit = document.getElementById("calculated-init");

        // --- –ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤ —Ä–∞—Å—ã ---
        const raceBonusInfoDiv = document.getElementById("race-bonus-info");
        const raceBonusesList = document.getElementById("race-bonuses-list");

        // --- –§—É–Ω–∫—Ü–∏–∏ ---

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á—ë—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
        function getMod(value) {
            return Math.floor((value - 10) / 2);
        }

        function formatMod(mod) {
            return mod >= 0 ? `+${mod}` : `${mod}`;
        }

        // --- –õ–æ–≥–∏–∫–∞ —Ä–∞—Å ---
        // –û–±—ä–µ–∫—Ç —Å –±–æ–Ω—É—Å–∞–º–∏ —Ä–∞—Å
        const raceBonuses = {
            "human": { str: 1, dex: 1, con: 1, int: 1, wis: 1, cha: 1, speed: 30, size: "Medium", languages: ["Common"] },
            "elf": { dex: 2, speed: 30, size: "Medium", languages: ["Common", "Elvish"] },
            "high-elf": { dex: 2, int: 1, speed: 30, size: "Medium", languages: ["Common", "Elvish"], "additional-language": 1 }, // +1 –ª—é–±–æ–π
            "wood-elf": { dex: 2, wis: 1, speed: 35, size: "Medium", languages: ["Common", "Elvish"] }, // –°–∫–æ—Ä–æ—Å—Ç—å 35
            "dark-elf": { dex: 2, cha: 1, speed: 30, size: "Medium", languages: ["Common", "Elvish", "Undercommon"] },
            "dwarf": { con: 2, speed: 25, size: "Medium", languages: ["Common", "Dwarvish"] }, // –°–∫–æ—Ä–æ—Å—Ç—å 25, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —è–¥—É
            "hill-dwarf": { con: 2, wis: 1, speed: 25, size: "Medium", languages: ["Common", "Dwarvish"] }, // +1 –•–ü/—É—Ä–æ–≤–µ–Ω—å
            "mountain-dwarf": { con: 2, str: 2, speed: 25, size: "Medium", languages: ["Common", "Dwarvish"] }, // –í–ª–∞–¥–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏–º–∏ –∏ —Ç—è–∂–µ–ª—ã–º–∏ –¥–æ—Å–ø–µ—Ö–∞–º–∏
            "halfling": { dex: 2, speed: 25, size: "Small", languages: ["Common", "Halfling"] },
            "lightfoot-halfling": { dex: 2, cha: 1, speed: 25, size: "Small", languages: ["Common", "Halfling"] }, // –•–∞—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç—Å—Ç–≤–æ
            "stout-halfling": { dex: 2, con: 1, speed: 25, size: "Small", languages: ["Common", "Halfling"] }, // –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —è–¥—É
            "gnome": { int: 2, speed: 25, size: "Small", languages: ["Common", "Gnomish"] },
            "forest-gnome": { int: 2, dex: 1, speed: 25, size: "Small", languages: ["Common", "Gnomish"] }, // –ú–∞–ª–∞—è –∏–ª–ª—é–∑–∏—è
            "rock-gnome": { int: 2, con: 1, speed: 25, size: "Small", languages: ["Common", "Gnomish"] }, // –†–µ–º–µ—Å–ª–µ–Ω–Ω–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ
            "half-orc": { str: 2, con: 1, speed: 30, size: "Medium", languages: ["Common", "Orc"] },
            "half-elf": { cha: 2, "choose-2-stats": 1, speed: 30, size: "Medium", languages: ["Common", "Elvish", "choice"] }, // +1 –ª—é–±–æ–π, +1 –ª—é–±–æ–π
            "tiefling": { cha: 2, int: 1, speed: 30, size: "Medium", languages: ["Common", "Infernal"] },
            "infernal-tiefling": { cha: 2, int: 1, speed: 30, size: "Medium", languages: ["Common", "Infernal"] }, // –¢–æ –∂–µ, —á—Ç–æ –∏ –æ–±—ã—á–Ω—ã–π —Ç–∏—Ñ–ª–∏–Ω–≥ –≤ PHB
            // –î—Ä—É–≥–∏–µ —Ä–∞—Å—ã (–ø—Ä–∏–º–µ—Ä—ã)
            "aarakocra": { dex: 2, wis: 1, speed: 25, fly: 50, size: "Medium", languages: ["Common", "Auran"] },
            "aasimar": { cha: 2, speed: 30, size: "Medium", languages: ["Common", "Celestial"] },
            "protector-aasimar": { cha: 2, wis: 1, speed: 30, size: "Medium", languages: ["Common", "Celestial"] },
            "scourge-aasimar": { cha: 2, con: 1, speed: 30, size: "Medium", languages: ["Common", "Celestial"] },
            "fallen-aasimar": { cha: 2, str: 1, speed: 30, size: "Medium", languages: ["Common", "Celestial"] },
            "autognome": { con: 1, int: 1, "choose-1-stat": 1, speed: 30, size: "Small", languages: ["Common", "Gnomish"] }, // +1 –∫ –æ–¥–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ –Ω–∞ –≤—ã–±–æ—Ä
            "bugbear": { str: 2, dex: 1, speed: 30, size: "Medium", languages: ["Common", "Goblin"] },
            "giff": { str: 2, con: 1, speed: 30, size: "Medium", languages: ["Common", "Giff"] },
            "gith": { "choose-2-stats": 1, speed: 30, size: "Medium", languages: ["Common", "Gith"] }, // +1 –∫ –¥–≤—É–º –Ω–∞ –≤—ã–±–æ—Ä
            "githyanki": { str: 2, int: 1, speed: 30, size: "Medium", languages: ["Common", "Gith"] },
            "githzerai": { wis: 2, con: 1, speed: 30, size: "Medium", languages: ["Common", "Gith"] },
            "simic-hybrid": { con: 2, "choose-1-stat": 1, speed: 30, size: "Medium", languages: ["Common", "choice"] }, // +1 –∫ –æ–¥–Ω–æ–π –Ω–∞ –≤—ã–±–æ—Ä, +1 —è–∑—ã–∫ –Ω–∞ –≤—ã–±–æ—Ä
            "verdan": { cha: 2, con: 1, speed: 30, size: "Small", languages: ["Common", "Goblin"] }, // –†–∞–∑–º–µ—Ä –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ Medium –Ω–∞ 5 —É—Ä–æ–≤–Ω–µ
            "vedalken": { int: 2, wis: 1, speed: 30, size: "Medium", languages: ["Common", "Vedalken", "choice"] }, // +1 —è–∑—ã–∫ –Ω–∞ –≤—ã–±–æ—Ä
            // –î–æ–±–∞–≤—å –±–æ–ª—å—à–µ —Ä–∞—Å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤ —Ä–∞—Å—ã
        function updateRaceBonuses() {
            const selectedRaceKey = raceSelect.value;
            const bonuses = raceBonuses[selectedRaceKey];

            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –±–æ–Ω—É—Å–æ–≤
            raceBonusesList.innerHTML = "";

            if (bonuses) {
                raceBonusInfoDiv.style.display = "block";
                let bonusesText = [];

                // –ë–æ–Ω—É—Å—ã –∫ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º
                for (const [stat, bonus] of Object.entries(bonuses)) {
                    if (["str", "dex", "con", "int", "wis", "cha"].includes(stat)) {
                        bonusesText.push(`+${bonus} –∫ ${stat.toUpperCase()}`);
                    }
                }
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã
                if (bonuses["choose-2-stats"] === 1) {
                     bonusesText.push("+1 –∫ –¥–≤—É–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º –Ω–∞ –≤—ã–±–æ—Ä');
                }
                if (bonuses["choose-1-stat"] === 1) {
                     bonusesText.push("+1 –∫ –æ–¥–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ –Ω–∞ –≤—ã–±–æ—Ä");
                }
                if (bonuses["additional-language"] === 1) {
                     bonusesText.push("+1 —è–∑—ã–∫ –Ω–∞ –≤—ã–±–æ—Ä");
                }
                if (bonuses["fly"]) {
                     bonusesText.push(`–°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª—ë—Ç–∞ ${bonuses["fly"]} —Ñ—É—Ç–æ–≤`);
                }
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤ (—Ä–∞–∑–º–µ—Ä, —è–∑—ã–∫–∏, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ —Ç.–¥.)

                if (bonusesText.length > 0) {
                    bonusesText.forEach(text => {
                        const li = document.createElement("li");
                        li.textContent = text;
                        raceBonusesList.appendChild(li);
                    });
                } else {
                     const li = document.createElement("li");
                     li.textContent = "–ë–∞–∑–æ–≤—ã–µ –±–æ–Ω—É—Å—ã (–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ —Ä–∞—Å—ã)";
                     raceBonusesList.appendChild(li);
                }
            } else {
                raceBonusInfoDiv.style.display = "none";
            }
        }

        // --- –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç –∏ —Ç.–¥.) ---
        // ... (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ –≤—ã–∑—ã–≤–∞–µ–º updateRaceBonuses –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) ...

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function updateCharacterInfo() {
            preview.name.textContent = nameInput.value || "–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞";
            // preview.race.textContent = raceSelect.value; // –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–ª—é—á, –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏
            // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –±—É–¥–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ option
            preview.race.textContent = raceSelect.options[raceSelect.selectedIndex].text;
            preview.class.textContent = classSelect.value;
            preview.level.textContent = levelInput.value;
            preview.bg.textContent = bgInput.value || "-";
            preview.align.textContent = alignSelect.value;
            preview.hp.textContent = currentHpInput.value || "0";
            preview.maxHp.textContent = maxHpInput.value || "0";
            preview.hd.textContent = hitDieInput.value || "-";
        }

         // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
         function updateCalculations() {
            const stats = {};
            for (let key in statsInputs) {
                stats[key] = parseInt(statsInputs[key].value) || 10;
            }

            // 1. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            const mods = {};
            for (let key in stats) {
                mods[key] = getMod(stats[key]);
            }

            // 2. –ö–î (–±–µ–∑ –¥–æ—Å–ø–µ—Ö–∞)
            const ac = 10 + mods.dex;
            calculatedAc.textContent = ac;
            preview.ac.textContent = ac;

            // 3. –°–∫–æ—Ä–æ—Å—Ç—å (–ø–æ–∫–∞ –±–∞–∑–æ–≤–∞—è, –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
            const speed = parseInt(baseSpeedInput.value) || 30;
            calculatedSpeed.textContent = speed;
            preview.speed.textContent = speed;

            // 4. –ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞
            const init = mods.dex;
            calculatedInit.textContent = formatMod(init);
            preview.init.textContent = formatMod(init);

            // 5. –ü–∞—Å—Å–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            const passDex = 10 + mods.dex; // –ü—Ä–∏–º–µ—Ä: –ø–∞—Å—Å–∏–≤–Ω–∞—è –ª–æ–≤–∫–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
            const passWis = 10 + mods.wis; // –ü–∞—Å—Å–∏–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ
            preview.passDex.textContent = passDex;
            preview.passWis.textContent = passWis;

            // 6. –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ (–ø–æ–∫–∞ –±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è)
            const savesHtml = `
                <li>–°–∏–ª–∞: ${formatMod(mods.str)}</li>
                <li>–õ–æ–≤–∫–æ—Å—Ç—å: ${formatMod(mods.dex)}</li>
                <li>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ: ${formatMod(mods.con)}</li>
                <li>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: ${formatMod(mods.int)}</li>
                <li>–ú—É–¥—Ä–æ—Å—Ç—å: ${formatMod(mods.wis)}</li>
                <li>–•–∞—Ä–∏–∑–º–∞: ${formatMod(mods.cha)}</li>
            `;
            preview.savesList.innerHTML = savesHtml;

            // 7. –ù–∞–≤—ã–∫–∏ (–ø–æ–∫–∞ –±–µ–∑ –±–æ–Ω—É—Å–∞ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞)
            const proficiencyBonus = Math.ceil(1 + (parseInt(levelInput.value) || 1) / 4);
            const skillsData = [
                { id: 'acrobatics', stat: 'dex', name: '–ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞' },
                { id: 'animal-handling', stat: 'wis', name: '–£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏' },
                { id: 'arcana', stat: 'int', name: '–ú–∞–≥–∏—è' },
                { id: 'athletics', stat: 'str', name: '–ê—Ç–ª–µ—Ç–∏–∫–∞' },
                { id: 'deception', stat: 'cha', name: '–û–±–º–∞–Ω' },
                { id: 'history', stat: 'int', name: '–ò—Å—Ç–æ—Ä–∏—è' },
                { id: 'insight', stat: 'wis', name: '–ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å' },
                { id: 'intimidation', stat: 'cha', name: '–ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ' },
                { id: 'investigation', stat: 'int', name: '–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ' },
                { id: 'medicine', stat: 'wis', name: '–ú–µ–¥–∏—Ü–∏–Ω–∞' },
                { id: 'nature', stat: 'int', name: '–ü—Ä–∏—Ä–æ–¥–∞' },
                { id: 'perception', stat: 'wis', name: '–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ' },
                { id: 'performance', stat: 'cha', name: '–í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ' },
                { id: 'persuasion', stat: 'cha', name: '–£–±–µ–∂–¥–µ–Ω–∏–µ' },
                { id: 'religion', stat: 'int', name: '–†–µ–ª–∏–≥–∏—è' },
                { id: 'sleight-of-hand', stat: 'dex', name: '–õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫' },
                { id: 'stealth', stat: 'dex', name: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å' },
                { id: 'survival', stat: 'wis', name: '–í—ã–∂–∏–≤–∞–Ω–∏–µ' }
            ];

            let skillsHtml = '';
            skillsData.forEach(skill => {
                 const isProficient = skillCheckboxes[skill.id] && skillCheckboxes[skill.id].checked;
                 const skillMod = mods[skill.stat] + (isProficient ? proficiencyBonus : 0);
                 skillsHtml += `<li>${skill.name}: ${formatMod(skillMod)}</li>`;
            });
            preview.skillsList.innerHTML = skillsHtml;

            // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ ---
            preview.strVal.textContent = stats.str;
            preview.dexVal.textContent = stats.dex;
            preview.conVal.textContent = stats.con;
            preview.intVal.textContent = stats.int;
            preview.wisVal.textContent = stats.wis;
            preview.chaVal.textContent = stats.cha;

            preview.strMod.textContent = formatMod(mods.str);
            preview.dexMod.textContent = formatMod(mods.dex);
            preview.conMod.textContent = formatMod(mods.con);
            preview.intMod.textContent = formatMod(mods.int);
            preview.wisMod.textContent = formatMod(mods.wis);
            preview.chaMod.textContent = formatMod(mods.cha);
        }

        // --- –°–ª—É—à–∞—Ç–µ–ª–∏ ---
        nameInput.addEventListener("input", updateCharacterInfo);
        raceSelect.addEventListener("change", () => { updateCharacterInfo(); updateRaceBonuses(); updateCalculations(); }); // –î–æ–±–∞–≤–∏–ª–∏ –≤—ã–∑–æ–≤ updateRaceBonuses –∏ updateCalculations
        classSelect.addEventListener("change", updateCharacterInfo);
        levelInput.addEventListener("input", () => { updateCharacterInfo(); updateCalculations(); });
        bgInput.addEventListener("input", updateCharacterInfo);
        alignSelect.addEventListener("change", updateCharacterInfo);
        expInput.addEventListener("input", updateCharacterInfo);

        currentHpInput.addEventListener("input", updateCharacterInfo);
        maxHpInput.addEventListener("input", updateCharacterInfo);
        hitDieInput.addEventListener("input", updateCharacterInfo);
        baseSpeedInput.addEventListener("input", () => { updateCharacterInfo(); updateCalculations(); });

        for (let key in statsInputs) {
            statsInputs[key].addEventListener("input", () => { updateCharacterInfo(); updateCalculations(); });
        }

        for (let key in skillCheckboxes) {
            skillCheckboxes[key].addEventListener("change", updateCalculations);
        }

        // --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ---
        // ... (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∫–ª—é—á —Ä–∞—Å—ã raceSelect.value) ...
        saveBtn.addEventListener("click", () => {
            const data = {
                name: nameInput.value,
                race: raceSelect.value, // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á
                class: classSelect.value,
                level: levelInput.value,
                background: bgInput.value,
                alignment: alignSelect.value,
                exp: expInput.value,
                stats: {},
                combat: {
                    hitDie: hitDieInput.value,
                    currentHp: currentHpInput.value,
                    maxHp: maxHpInput.value,
                    baseSpeed: baseSpeedInput.value
                },
                skills: {}
            };
            for (let key in statsInputs) {
                data.stats[key] = statsInputs[key].value;
            }
            for (let key in skillCheckboxes) {
                data.skills[key] = skillCheckboxes[key].checked;
            }
            localStorage.setItem("dnd-character", JSON.stringify(data));
            alert("‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–æ—Ö—Ä–∞–Ω—ë–Ω!");
        });

        // --- –≠–∫—Å–ø–æ—Ä—Ç ---
        // ... (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

        // --- –°–±—Ä–æ—Å ---
        // ... (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

        // --- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ ---
        const saved = localStorage.getItem("dnd-character");
        if (saved) {
            try {
                const data = JSON.parse(saved);
                nameInput.value = data.name || "";
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ select –ø–æ –∫–ª—é—á—É
                if (data.race && raceSelect.querySelector(`option[value="${data.race}"]`)) {
                     raceSelect.value = data.race;
                } else {
                     raceSelect.value = "human"; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
                }
                classSelect.value = data.class || "–≤–æ–∏–Ω";
                levelInput.value = data.level || "1";
                bgInput.value = data.background || "";
                alignSelect.value = data.alignment || "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π";
                expInput.value = data.exp || "0";
                for (let key in data.stats) {
                    if (statsInputs[key]) {
                        statsInputs[key].value = data.stats[key];
                    }
                }
                if (data.combat) {
                     hitDieInput.value = data.combat.hitDie || "";
                     currentHpInput.value = data.combat.currentHp || "";
                     maxHpInput.value = data.combat.maxHp || "";
                     baseSpeedInput.value = data.combat.baseSpeed || "30";
                }
                if (data.skills) {
                     for (let key in data.skills) {
                         if (skillCheckboxes[key] !== undefined) {
                             skillCheckboxes[key].checked = data.skills[key];
                         }
                     }
                }
                updateCharacterInfo();
                updateCalculations();
                updateRaceBonuses(); // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–Ω—É—Å—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞", e);
            }
        }

        // --- –ü–µ—Ä–≤–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ---
        updateCharacterInfo();
        updateCalculations();
        updateRaceBonuses(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–æ–Ω—É—Å—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
    });
  </script>
</body>
</html>
