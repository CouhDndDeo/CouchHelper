<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üßæ –õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</title>
  <link rel="stylesheet" href="../../style.css" />
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
  <style>
    /* === –û–°–ù–û–í–ù–û–ô –ú–ê–ö–ï–¢: –í–ï–†–¢–ò–ö–ê–õ–¨–ù–´–ô –ü–û–¢–û–ö === */
    .main-layout {
      display: flex;
      flex-direction: column;
      gap: 30px;
      margin: 20px 0;
    }
    .form-section {
      background-color: #4a2f1a;
      padding: 20px;
      border-radius: 12px;
      border: 2px solid #8b6f47;
      margin-bottom: 20px;
      box-shadow: 
        0 6px 0 #3a2410,
        0 6px 15px rgba(0, 0, 0, 0.5);
    }
    .form-section h3 {
      color: #d4af37;
      margin-top: 0;
      border-left: 5px solid #d4af37;
      padding-left: 15px;
      margin-bottom: 20px;
      font-size: 1.6em;
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    .form-row > label {
      flex: 1;
      min-width: 200px;
    }
    .form-row input,
    .form-row select {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 8px;
      border: 2px solid #8b6f47;
      background: #5a3b26;
      color: #e0ccb6;
      font-size: 1em;
      box-sizing: border-box;
    }
    .form-row input:focus,
    .form-row select:focus {
      outline: none;
      border-color: #d4af37;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
    }
    /* === –ö–ù–û–ü–ö–ò –í –ï–î–ò–ù–û–ú –°–¢–ò–õ–ï === */
    .form-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 30px;
    }
    .btn-primary, .btn-secondary, .btn-clear {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1.1em;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-primary {
      background: #d4af37;
      color: #1a110a;
    }
    .btn-secondary {
      background: #5a3b26;
      color: #d4af37;
      border: 2px solid #8b6f47;
    }
    .btn-clear {
      background: #8b4513;
      color: #fff;
    }
    .btn-primary:hover,
    .btn-secondary:hover,
    .btn-clear:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    .btn-primary:active,
    .btn-secondary:active,
    .btn-clear:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }
    /* === –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò === */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }
    .stat-box {
      text-align: center;
      background: #5a3b26;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #8b6f47;
      position: relative;
    }
    .stat-box label {
      font-size: 1.1em;
      color: #d4af37;
      display: block;
      margin-bottom: 10px;
    }
    .stat-box input {
      width: 100%;
      text-align: center;
      font-size: 1.5em;
      font-weight: bold;
      padding: 10px;
      border-radius: 8px;
      border: 2px solid #8b6f47;
      background: #4a2e1a;
      color: #e0ccb6;
      box-sizing: border-box;
    }
    .stat-mod {
      font-size: 1.2em;
      color: #b8a594;
      margin-top: 10px;
      font-weight: bold;
    }
    /* === –ü–ê–°–°–ò–í–ù–û–ï –í–û–°–ü–†–ò–Ø–¢–ò–ï === */
    .passive-perception {
      font-size: 1em;
      color: #d4af37;
      margin-top: 10px;
      font-style: italic;
    }
    /* === –ë–û–ù–£–° –û–¢ –†–ê–°–´ === */
    .stat-bonus {
      font-size: 0.9em;
      color: #d4af37;
      margin-top: 8px;
      cursor: help;
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      background: rgba(212, 175, 55, 0.1);
      border: 1px dashed #d4af37;
    }
    .stat-bonus:hover::after {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #1a110a;
      color: #d4af37;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #d4af37;
      white-space: nowrap;
      z-index: 100;
      font-size: 0.9em;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    /* === –ù–ê–í–´–ö–ò === */
    .skills-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      list-style: none;
      padding: 0;
      margin-top: 15px;
    }
    .skills-grid li {
      font-size: 1em;
    }
    .skills-grid label {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      background: rgba(90, 59, 38, 0.3);
      border: 1px solid #8b6f47;
      transition: background 0.3s;
    }
    .skills-grid label:hover {
      background: rgba(139, 111, 71, 0.3);
    }
    .skills-grid input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.3);
    }
    /* === –°–í–û–î–ö–ê –ü–ï–†–°–û–ù–ê–ñ–ê === */
    .summary-section {
      background: linear-gradient(145deg, #5a3b26, #4a2e1a);
      border: 2px solid #8b6f47;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 
        0 6px 0 #3a2410,
        0 6px 15px rgba(0, 0, 0, 0.5);
      text-align: center;
      margin-top: 40px;
    }
    .summary-section h2 {
      color: #d4af37;
      margin-bottom: 20px;
      border-left: 5px solid #d4af37;
      padding-left: 15px;
    }
    .avatar-container {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 3px solid #d4af37;
      overflow: hidden;
      margin: 0 auto 20px;
      background-color: #3a2410;
    }
    .avatar-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .summary-name {
      font-size: 2em;
      color: #f0d98f;
      margin-bottom: 15px;
    }
    .summary-details {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 25px;
      font-size: 1.1em;
    }
    .summary-details > div {
      border-right: 2px solid #8b6f47;
      padding: 0 15px;
    }
    .summary-details > div:last-child {
      border-right: none;
    }
    .summary-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin: 25px 0;
    }
    .summary-stat {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px 10px;
      border-radius: 10px;
      border: 1px solid #8b6f47;
    }
    .summary-stat-name {
      font-size: 0.9em;
      color: #b8a594;
      margin-bottom: 5px;
    }
    .summary-stat-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #f0d98f;
    }
    .summary-stat-mod {
      font-size: 1.1em;
      color: #d4af37;
    }
    .summary-combat {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px 0;
      padding: 15px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      font-size: 1.1em;
    }
    .summary-quick-info {
      text-align: left;
      margin-top: 30px;
    }
    .summary-quick-info h4 {
      color: #d4af37;
      border-bottom: 1px solid #8b6f47;
      padding-bottom: 5px;
      margin: 20px 0 10px;
    }
    .summary-quick-info ul {
      list-style-type: none;
      padding-left: 15px;
      margin: 0;
      columns: 2;
      column-gap: 30px;
    }
    .summary-quick-info li {
      margin-bottom: 5px;
      padding: 3px 0;
      border-bottom: 1px dotted #5a3b26;
    }
    footer {
      text-align: center;
      margin-top: 50px;
      color: #a89b8c;
      font-style: italic;
      padding-top: 25px;
      border-top: 1px dashed #5a3b26;
    }
    @media (max-width: 768px) {
      .form-row {
        flex-direction: column;
        gap: 15px;
      }
      .form-row > label {
        min-width: 100%;
      }
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .skills-grid {
        grid-template-columns: 1fr;
      }
      .summary-details {
        flex-direction: column;
        align-items: center;
      }
      .summary-details > div {
        border-right: none;
        padding: 8px 0;
      }
      .summary-quick-info ul {
        columns: 1;
      }
    }
    /* === –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò: 3 —Å—Ç–æ–ª–±—Ü–∞ –ø–æ 2 —Å—Ç—Ä–æ–∫–∏ === */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin: 25px 0;
}
.stat-box {
  text-align: center;
  background: #5a3b26;
  padding: 15px;
  border-radius: 10px;
  border: 2px solid #8b6f47;
  position: relative;
}
.stat-box label {
  font-size: 1.1em;
  color: #d4af37;
  display: block;
  margin-bottom: 10px;
}
.stat-box input {
  width: 100%;
  text-align: center;
  font-weight: bold;
  font-size: 1.4em;
  padding: 8px;
  border-radius: 8px;
  border: 2px solid #8b6f47;
  background: #4a2e1a;
  color: #e0ccb6;
  box-sizing: border-box;
}
.stat-box input:focus {
  outline: none;
  border-color: #d4af37;
  box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
}
.stat-mod {
  font-size: 1em;
  color: #b8a594;
  margin-top: 10px;
  font-weight: bold;
}
.stat-bonus {
  font-size: 0.9em;
  color: #d4af37;
  margin-top: 8px;
  cursor: help;
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  background: rgba(212, 175, 55, 0.1);
  border: 1px dashed #d4af37;
}
.stat-bonus:hover::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: #1a110a;
  color: #d4af37;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #d4af37;
  white-space: nowrap;
  z-index: 100;
  font-size: 0.9em;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}
.stat-bonus:hover {
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
}
.passive-perception {
  font-size: 0.9em;
  color: #d4af37;
  margin-top: 10px;
  font-style: italic;
}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üßæ –õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h1>
      <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º D&D 5e</p>
    </header>
    <nav>
      <a href="../rules-dnd.html" class="btn-back">
        <span class="arrow">‚Üê</span>
        <span class="text">–í –º–µ–Ω—é D&D</span>
      </a>
    </nav>
    <main class="main-layout">
      <!-- üìù –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
      <section class="form-section">
        <h3>üìù –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
        <div class="form-row">
          <label>
            –ò–º—è:
            <input type="text" id="char-name" placeholder="–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞" />
          </label>
          <label>
            –ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:
            <input type="text" id="char-background" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ—Å—Ç–æ–ª—é–¥–∏–Ω" />
          </label>
        </div>
        <div class="form-row">
          <label>
            –ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ:
            <select id="char-alignment">
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–¥–æ–±—Ä—ã–π</option>
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–ó–∞–∫–æ–Ω–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π">–•–∞–æ—Ç–∏—á–Ω–æ-–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</option>
              <option value="–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π">–ó–∞–∫–æ–Ω–Ω–æ-–∑–ª–æ–π</option>
              <option value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–∑–ª–æ–π</option>
              <option value="–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π">–•–∞–æ—Ç–∏—á–Ω–æ-–∑–ª–æ–π</option>
            </select>
          </label>
          <label>
            –û–ø—ã—Ç:
            <input type="number" id="char-exp" value="0" />
          </label>
        </div>
        <div class="form-row">
          <label>
            –ê–≤–∞—Ç–∞—Ä:
            <input type="file" id="avatar-upload" accept="image/*">
          </label>
        </div>
      </section>
      <!-- üß¨ –†–∞—Å–∞ –∏ –ö–ª–∞—Å—Å -->
      <section class="form-section">
        <h3>üß¨ –†–∞—Å–∞ –∏ –ö–ª–∞—Å—Å</h3>
        <div class="form-row">
          <label>
            –†–∞—Å–∞:
            <select id="char-race">
              <option value="human">–ß–µ–ª–æ–≤–µ–∫</option>
              <option value="elf">–≠–ª—å—Ñ</option>
              <option value="dwarf">–î–≤–∞—Ä—Ñ</option>
              <option value="halfling">–ü–æ–ª—É—Ä–æ—Å–ª–∏–∫</option>
              <option value="gnome">–ì–Ω–æ–º</option>
              <option value="half-elf">–ü–æ–ª—É—ç–ª—å—Ñ</option>
              <option value="half-orc">–ü–æ–ª—É–æ—Ä–∫</option>
              <option value="tiefling">–¢–∏—Ñ–ª–∏–Ω–≥</option>
              <option value="aarakocra">–ê–∞—Ä–∞–∫–æ–∫—Ä–∞</option>
              <option value="aasimar">–ê–∞—Å–∏–º–∞—Ä</option>
              <option value="bugbear">–ë–∞–≥–±–∏—Ä</option>
              <option value="gith">–ì–∏—Ç</option>
              <option value="giff">–ì–∏—Ñ—Ñ</option>
              <option value="simic-hybrid">–ì–∏–±—Ä–∏–¥ –°–∏–º–∏–∫–æ–≤</option>
              <option value="verdan">–í–µ—Ä–¥–∞–Ω</option>
              <option value="vedalken">–í–µ–¥–∞–ª–∫–µ–Ω</option>
              <option value="autognome">–ê–≤—Ç–æ–≥–Ω–æ–º</option>
              <!-- –î–æ–±–∞–≤—å –±–æ–ª—å—à–µ —Ä–∞—Å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ -->
            </select>
          </label>
          <label>
            –ö–ª–∞—Å—Å:
            <select id="char-class">
              <option value="–≤–æ–∏–Ω">–í–æ–∏–Ω</option>
              <option value="–º–∞–≥">–ú–∞–≥</option>
              <option value="–∂—Ä–µ—Ü">–ñ—Ä–µ—Ü</option>
              <option value="—Ä–∞–∑–±–æ–π–Ω–∏–∫">–†–∞–∑–±–æ–π–Ω–∏–∫</option>
              <option value="–ø–∞–ª–∞–¥–∏–Ω">–ü–∞–ª–∞–¥–∏–Ω</option>
              <option value="—Å–ª–µ–¥–æ–ø—ã—Ç">–°–ª–µ–¥–æ–ø—ã—Ç</option>
              <option value="–≤–∞—Ä–≤–∞—Ä">–í–∞—Ä–≤–∞—Ä</option>
              <option value="–¥—Ä—É–∏–¥">–î—Ä—É–∏–¥</option>
              <option value="–±–∞—Ä–¥">–ë–∞—Ä–¥</option>
              <option value="—á–∞—Ä–æ–¥–µ–π">–ß–∞—Ä–æ–¥–µ–π</option>
              <option value="–∫–æ–ª–¥—É–Ω">–ö–æ–ª–¥—É–Ω</option>
              <option value="–º–æ–Ω–∞—Ö">–ú–æ–Ω–∞—Ö</option>
            </select>
          </label>
          <label>
            –£—Ä–æ–≤–µ–Ω—å:
            <input type="number" id="char-level" min="1" max="20" value="1" />
          </label>
        </div>
      </section>
      <!-- üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
      <div class="form-section">
  <h3>üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
  <div class="stats-grid">
    <div class="stat-box">
      <label for="str">–°–ò–õ</label>
      <input type="number" id="str" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="str-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="str-bonus">+0</span></div>
    </div>
    <div class="stat-box">
      <label for="dex">–õ–û–í</label>
      <input type="number" id="dex" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="dex-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="dex-bonus">+0</span></div>
    </div>
    <div class="stat-box">
      <label for="con">–¢–ï–õ</label>
      <input type="number" id="con" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="con-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="con-bonus">+0</span></div>
    </div>
    <div class="stat-box">
      <label for="int">–ò–ù–¢</label>
      <input type="number" id="int" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="int-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="int-bonus">+0</span></div>
    </div>
    <div class="stat-box">
      <label for="wis">–ú–î–†</label>
      <input type="number" id="wis" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="wis-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="wis-bonus">+0</span></div>
      <div class="passive-perception">–ü–∞—Å—Å–∏–≤–Ω–æ–µ –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: <span id="passive-perception">10</span></div>
    </div>
    <div class="stat-box">
      <label for="cha">–•–ê–†</label>
      <input type="number" id="cha" min="3" max="20" value="10" />
      <div class="stat-mod">–º–æ–¥ (<span id="cha-mod">+0</span>)</div>
      <div class="stat-bonus" title="–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞"><span id="cha-bonus">+0</span></div>
    </div>
  </div>
</div>
      <!-- üõ°Ô∏è –ë–æ–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ -->
      <section class="form-section">
        <h3>üõ°Ô∏è –ë–æ–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
        <div class="form-row">
          <label>
            –ö–æ—Å—Ç—å –•–∏—Ç–æ–≤ (HD):
            <input type="text" id="hit-die" placeholder="1–∫10" readonly />
          </label>
          <label>
            –¢–µ–∫—É—â–∏–µ –•–ü:
            <input type="number" id="current-hp" placeholder="–¢–µ–∫—É—â–∏–µ" />
          </label>
          <label>
            –ú–∞–∫—Å. –•–ü:
            <input type="number" id="max-hp" placeholder="–ú–∞–∫—Å–∏–º—É–º" />
          </label>
        </div>
        <div class="form-row">
          <label>
            –ö–î (–±–µ–∑ –¥–æ—Å–ø–µ—Ö–∞):
            <span id="calculated-ac">10</span>
          </label>
          <label>
            –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (—Ñ—É—Ç—ã):
            <input type="number" id="base-speed" value="30" />
          </label>
          <label>
            –°–∫–æ—Ä–æ—Å—Ç—å (—Ñ—É—Ç—ã):
            <span id="calculated-speed">30</span>
          </label>
        </div>
        <div class="form-row">
          <label>
            –ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞:
            <span id="calculated-init">+0</span>
          </label>
        </div>
        <div class="form-row">
          <label>
            –ë–æ–Ω—É—Å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞:
            <span id="proficiency-bonus">+2</span>
          </label>
</div>
      </section>
      <!-- üéØ –ù–∞–≤—ã–∫–∏ -->
      <section class="form-section">
        <h3>üéØ –ù–∞–≤—ã–∫–∏</h3>
        <div class="skill-ownership-notice" style="margin-bottom: 15px; font-style: italic; color: #d4af37;">
          –í—ã –≤–ª–∞–¥–µ–µ—Ç–µ –Ω–∞–≤—ã–∫–∞–º–∏: <strong>‚Äî</strong>. –ü—Ä–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫–∏ –Ω–∏–∂–µ.
        </div>
        <ul class="skills-grid">
          <li><label><input type="checkbox" id="skill-acrobatics"> –ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞ (DEX)</label></li>
          <li><label><input type="checkbox" id="skill-animal-handling"> –£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏ (WIS)</label></li>
          <li><label><input type="checkbox" id="skill-arcana"> –ú–∞–≥–∏—è (INT)</label></li>
          <li><label><input type="checkbox" id="skill-athletics"> –ê—Ç–ª–µ—Ç–∏–∫–∞ (STR)</label></li>
          <li><label><input type="checkbox" id="skill-deception"> –û–±–º–∞–Ω (CHA)</label></li>
          <li><label><input type="checkbox" id="skill-history"> –ò—Å—Ç–æ—Ä–∏—è (INT)</label></li>
          <li><label><input type="checkbox" id="skill-insight"> –ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (WIS)</label></li>
          <li><label><input type="checkbox" id="skill-intimidation"> –ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ (CHA)</label></li>
          <li><label><input type="checkbox" id="skill-investigation"> –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (INT)</label></li>
          <li><label><input type="checkbox" id="skill-medicine"> –ú–µ–¥–∏—Ü–∏–Ω–∞ (WIS)</label></li>
          <li><label><input type="checkbox" id="skill-nature"> –ü—Ä–∏—Ä–æ–¥–∞ (INT)</label></li>
          <li><label><input type="checkbox" id="skill-perception"> –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ (WIS)</label></li>
          <li><label><input type="checkbox" id="skill-performance"> –í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ (CHA)</label></li>
          <li><label><input type="checkbox" id="skill-persuasion"> –£–±–µ–∂–¥–µ–Ω–∏–µ (CHA)</label></li>
          <li><label><input type="checkbox" id="skill-religion"> –†–µ–ª–∏–≥–∏—è (INT)</label></li>
          <li><label><input type="checkbox" id="skill-sleight-of-hand"> –õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫ (DEX)</label></li>
          <li><label><input type="checkbox" id="skill-stealth"> –°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å (DEX)</label></li>
          <li><label><input type="checkbox" id="skill-survival"> –í—ã–∂–∏–≤–∞–Ω–∏–µ (WIS)</label></li>
        </ul>
      </section>
      <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
      <div class="form-buttons">
        <button id="save-char" class="btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="export-char" class="btn-secondary">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
        <button id="reset-char" class="btn-clear">üóëÔ∏è –°–±—Ä–æ—Å</button>
        <button id="print-char" class="btn-secondary" onclick="window.print()">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
      </div>
      <!-- üé≠ –°–≤–æ–¥–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ -->
      <section class="summary-section">
        <h2>üé≠ –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–∂</h2>
        <div class="avatar-container">
          <img id="summary-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Crect width='120' height='120' fill='%233a2a1a'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='60' fill='%23d4af37'%3E%F0%9F%91%A4%3C/text%3E%3C/svg%3E" alt="–ê–≤–∞—Ç–∞—Ä">
        </div>
        <div class="summary-name" id="summary-name">–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</div>
        <div class="summary-details">
          <div><strong>–†–∞—Å–∞:</strong> <span id="summary-race">—á–µ–ª–æ–≤–µ–∫</span></div>
          <div><strong>–ö–ª–∞—Å—Å:</strong> <span id="summary-class">–≤–æ–∏–Ω</span></div>
          <div><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> <span id="summary-level">1</span></div>
          <div><strong>–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:</strong> <span id="summary-bg">-</span></div>
          <div><strong>–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ:</strong> <span id="summary-align">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</span></div>
        </div>
        <div class="summary-stats">
          <div class="summary-stat">
            <div class="summary-stat-name">–°–ò–õ</div>
            <div class="summary-stat-value" id="summary-str-val">10</div>
            <div class="summary-stat-mod" id="summary-str-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–õ–û–í</div>
            <div class="summary-stat-value" id="summary-dex-val">10</div>
            <div class="summary-stat-mod" id="summary-dex-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–¢–ï–õ</div>
            <div class="summary-stat-value" id="summary-con-val">10</div>
            <div class="summary-stat-mod" id="summary-con-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–ò–ù–¢</div>
            <div class="summary-stat-value" id="summary-int-val">10</div>
            <div class="summary-stat-mod" id="summary-int-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–ú–î–†</div>
            <div class="summary-stat-value" id="summary-wis-val">10</div>
            <div class="summary-stat-mod" id="summary-wis-mod">+0</div>
            <div class="passive-perception">–ü–∞—Å—Å–∏–≤–Ω–æ–µ –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: <span id="summary-pass-wis">10</span></div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–•–ê–†</div>
            <div class="summary-stat-value" id="summary-cha-val">10</div>
            <div class="summary-stat-mod" id="summary-cha-mod">+0</div>
          </div>
        </div>
        <div class="summary-combat">
          <div><strong>–ö–î:</strong> <span id="summary-ac">10</span></div>
          <div><strong>–•–ü:</strong> <span id="summary-hp">0</span>/<span id="summary-max-hp">0</span></div>
          <div><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> <span id="summary-speed">30</span> —Ñ—É—Ç–æ–≤</div>
          <div><strong>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞:</strong> <span id="summary-init">+0</span></div>
          <div><strong>–ë–æ–Ω—É—Å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞:</strong> <span id="summary-prof-bonus">+2</span></div>
        </div>
        <div class="summary-quick-info">
          <div style="display: flex; gap: 40px; flex-wrap: wrap;">
            <div>
              <h4>–°–ø–∞—Å–±—Ä–æ—Å–∫–∏</h4>
              <ul id="summary-saves">
                <li>–°–∏–ª: +0</li>
                <li>–õ–æ–≤: +0</li>
                <li>–¢–µ–ª: +0</li>
                <li>–ò–Ω—Ç: +0</li>
                <li>–ú–¥—Ä: +0</li>
                <li>–•–∞—Ä: +0</li>
              </ul>
            </div>
            <div>
              <h4>–ù–∞–≤—ã–∫–∏</h4>
              <ul id="summary-skills">
                <li>–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: +0</li>
                <li>–ê—Ç–ª–µ—Ç–∏–∫–∞: +0</li>
                <li>... (–≤—ã–±–µ—Ä–∏—Ç–µ –≤ —Ñ–æ—Ä–º–µ)</li>
              </ul>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer>
      <p>–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–ª—è D&D 5e</p>
    </footer>
  </div>
      <script>
document.addEventListener("DOMContentLoaded", () => {
  // --- –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã ---
  const nameInput = document.getElementById("char-name");
  const raceSelect = document.getElementById("char-race");
  const classSelect = document.getElementById("char-class");
  const levelInput = document.getElementById("char-level");
  const bgInput = document.getElementById("char-background");
  const alignSelect = document.getElementById("char-alignment");
  const expInput = document.getElementById("char-exp");
  const avatarUpload = document.getElementById("avatar-upload");
  const statsInputs = {
    str: document.getElementById("str"),
    dex: document.getElementById("dex"),
    con: document.getElementById("con"),
    int: document.getElementById("int"),
    wis: document.getElementById("wis"),
    cha: document.getElementById("cha")
  };
  const hitDieInput = document.getElementById("hit-die");
  const currentHpInput = document.getElementById("current-hp");
  const maxHpInput = document.getElementById("max-hp");
  const baseSpeedInput = document.getElementById("base-speed");
  const skillCheckboxes = {};
  document.querySelectorAll('.skills-grid input[type="checkbox"]').forEach(cb => {
    skillCheckboxes[cb.id.replace('skill-', '')] = cb;
  });
  const saveBtn = document.getElementById("save-char");
  const exportBtn = document.getElementById("export-char");
  const resetBtn = document.getElementById("reset-char");
  const printBtn = document.getElementById("print-char");

  // --- –≠–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ ---
  const summaryAvatar = document.getElementById("summary-avatar");
  const preview = {
    name: document.getElementById("summary-name"),
    race: document.getElementById("summary-race"),
    class: document.getElementById("summary-class"),
    level: document.getElementById("summary-level"),
    bg: document.getElementById("summary-bg"),
    align: document.getElementById("summary-align"),
    // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    strVal: document.getElementById("summary-str-val"),
    dexVal: document.getElementById("summary-dex-val"),
    conVal: document.getElementById("summary-con-val"),
    intVal: document.getElementById("summary-int-val"),
    wisVal: document.getElementById("summary-wis-val"),
    chaVal: document.getElementById("summary-cha-val"),
    strMod: document.getElementById("summary-str-mod"),
    dexMod: document.getElementById("summary-dex-mod"),
    conMod: document.getElementById("summary-con-mod"),
    intMod: document.getElementById("summary-int-mod"),
    wisMod: document.getElementById("summary-wis-mod"),
    chaMod: document.getElementById("summary-cha-mod"),
    passWis: document.getElementById("summary-pass-wis"),
    // –ë–æ–µ–≤—ã–µ
    ac: document.getElementById("summary-ac"),
    speed: document.getElementById("summary-speed"),
    init: document.getElementById("summary-init"),
    hp: document.getElementById("summary-hp"),
    maxHp: document.getElementById("summary-max-hp"),
    profBonus: document.getElementById("summary-prof-bonus"), // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω ID
    // –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ –∏ –Ω–∞–≤—ã–∫–∏
    savesList: document.getElementById("summary-saves"),
    skillsList: document.getElementById("summary-skills")
  };

  // --- –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è ---
  const calculatedAc = document.getElementById("calculated-ac");
  const calculatedSpeed = document.getElementById("calculated-speed");
  const calculatedInit = document.getElementById("calculated-init");
  const passivePerception = document.getElementById("passive-perception");
  const proficiencyBonusElement = document.getElementById("proficiency-bonus");

  // --- –ë–æ–Ω—É—Å—ã –æ—Ç —Ä–∞—Å—ã –∏ –∫–ª–∞—Å—Å–∞ ---
  const statBonuses = {
    str: document.getElementById("str-bonus"),
    dex: document.getElementById("dex-bonus"),
    con: document.getElementById("con-bonus"),
    int: document.getElementById("int-bonus"),
    wis: document.getElementById("wis-bonus"),
    cha: document.getElementById("cha-bonus")
  };

  // --- –î–∞–Ω–Ω—ã–µ –∏–∑ JSON ---
  let raceClassData = {};
  let dataLoaded = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

  // --- –§—É–Ω–∫—Ü–∏–∏ ---
  function getMod(value) {
    return Math.floor((value - 10) / 2);
  }
  function formatMod(mod) {
    return mod >= 0 ? `+${mod}` : `${mod}`;
  }

  function updateSkillOwnership() {
    if (!dataLoaded) return; // –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
    const raceKey = raceSelect.value;
    const classKey = classSelect.value;
    const race = raceClassData.races?.[raceKey];
    const cls = raceClassData.classes?.[classKey];
    const ownedSkills = new Set();
    if (race?.skills) {
      race.skills.forEach(skill => ownedSkills.add(skill));
    }
    if (cls?.skills) {
      cls.skills.forEach(skill => ownedSkills.add(skill));
    }
    const skillList = Array.from(ownedSkills).join(", ") || "‚Äî";
    const skillNotice = document.querySelector(".skill-ownership-notice");
    if (skillNotice) {
      skillNotice.innerHTML = `–í—ã –≤–ª–∞–¥–µ–µ—Ç–µ –Ω–∞–≤—ã–∫–∞–º–∏: <strong>${skillList}</strong>. –ü—Ä–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫–∏ –Ω–∏–∂–µ.`;
    }
  }

  // --- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ---
  function updateAll() {
    // 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∏ –∏—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
    const stats = {};
    for (let key in statsInputs) {
      let val = parseInt(statsInputs[key].value) || 10;
      val = Math.max(3, Math.min(20, val));
      statsInputs[key].value = val;
      stats[key] = val;
    }
    const mods = {};
    for (let key in stats) {
      mods[key] = getMod(stats[key]);
    }

    // 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ –ø–æ–ª—è—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    document.getElementById("str-mod").textContent = formatMod(mods.str);
    document.getElementById("dex-mod").textContent = formatMod(mods.dex);
    document.getElementById("con-mod").textContent = formatMod(mods.con);
    document.getElementById("int-mod").textContent = formatMod(mods.int);
    document.getElementById("wis-mod").textContent = formatMod(mods.wis);
    document.getElementById("cha-mod").textContent = formatMod(mods.cha);

    // 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –æ—Ç —Ä–∞—Å—ã –∏ –∫–ª–∞—Å—Å–∞ (–ø–æ–¥—Å–∫–∞–∑–∫–∏)
    // –°–±—Ä–æ—Å –±–æ–Ω—É—Å–æ–≤
    for (let key in statBonuses) {
        statBonuses[key].textContent = "+0";
        statBonuses[key].title = "–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞";
        statBonuses[key].style.display = "inline-block"; // –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –≤–∏–¥–µ–Ω
    }

    if (dataLoaded) { // –ü—Ä–∏–º–µ–Ω—è—Ç—å –±–æ–Ω—É—Å—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        const raceKey = raceSelect.value;
        const classKey = classSelect.value;
        const raceData = raceClassData.races?.[raceKey];
        const classData = raceClassData.classes?.[classKey];

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –æ—Ç —Ä–∞—Å—ã
        if (raceData?.stats) {
            for (let key in raceData.stats) {
                if (["str", "dex", "con", "int", "wis", "cha"].includes(key)) {
                    const bonus = raceData.stats[key];
                    const currentBonusText = statBonuses[key].textContent;
                    const currentBonusValue = parseInt(currentBonusText) || 0;
                    const newBonusValue = currentBonusValue + bonus;
                    statBonuses[key].textContent = formatMod(newBonusValue);
                    statBonuses[key].title = `–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã "${raceSelect.options[raceSelect.selectedIndex].text}": ${formatMod(bonus)}`;
                }
            }
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –æ—Ç –∫–ª–∞—Å—Å–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        if (classData?.stats) {
            for (let key in classData.stats) {
                if (["str", "dex", "con", "int", "wis", "cha"].includes(key)) {
                    const bonus = classData.stats[key];
                    const currentBonusText = statBonuses[key].textContent;
                    const currentBonusValue = parseInt(currentBonusText) || 0;
                    const newBonusValue = currentBonusValue + bonus;
                    statBonuses[key].textContent = formatMod(newBonusValue);
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—É–ª—Ç–∏–ø–∞
                    if (statBonuses[key].title && statBonuses[key].title !== "–ë–æ–Ω—É—Å –æ—Ç —Ä–∞—Å—ã –∏–ª–∏ –∫–ª–∞—Å—Å–∞") {
                        statBonuses[key].title += `, –ë–æ–Ω—É—Å –æ—Ç –∫–ª–∞—Å—Å–∞ "${classSelect.options[classSelect.selectedIndex].text}": ${formatMod(bonus)}`;
                    } else {
                        statBonuses[key].title = `–ë–æ–Ω—É—Å –æ—Ç –∫–ª–∞—Å—Å–∞ "${classSelect.options[classSelect.selectedIndex].text}": ${formatMod(bonus)}`;
                    }
                }
            }
        }

        // –°–∫–æ—Ä–æ—Å—Ç—å –∏–∑ —Ä–∞—Å—ã
        if (raceData?.speed !== undefined) {
            baseSpeedInput.value = raceData.speed;
        }
    }

    // 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ö–æ—Å—Ç–∏ –•–∏—Ç–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–∞
    if (dataLoaded) {
        const classKey = classSelect.value;
        const classData = raceClassData.classes?.[classKey];
        const hd = classData?.hitDie || "1–∫8";
        hitDieInput.value = hd;
    }

    // 5. –ö–î (–±–µ–∑ –¥–æ—Å–ø–∞—Ö–∞)
    const ac = 10 + mods.dex;
    calculatedAc.textContent = ac;
    preview.ac.textContent = ac;

    // 6. –°–∫–æ—Ä–æ—Å—Ç—å
    const speed = parseInt(baseSpeedInput.value) || 30;
    calculatedSpeed.textContent = speed;
    preview.speed.textContent = speed;

    // 7. –ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞
    const init = mods.dex;
    calculatedInit.textContent = formatMod(init);
    preview.init.textContent = formatMod(init);

    // 8. –ë–æ–Ω—É—Å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞
    const level = parseInt(levelInput.value) || 1;
    const proficiencyBonus = Math.ceil(1 + level / 4);
    proficiencyBonusElement.textContent = formatMod(proficiencyBonus);
    preview.profBonus.textContent = formatMod(proficiencyBonus); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å–≤–æ–¥–∫–µ

    // 9. –ü–∞—Å—Å–∏–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ (—Å —É—á–µ—Ç–æ–º –≤–ª–∞–¥–µ–Ω–∏—è)
    const isPerceptionProficient = skillCheckboxes['perception'] && skillCheckboxes['perception'].checked;
    const passiveWis = 10 + mods.wis + (isPerceptionProficient ? proficiencyBonus : 0);
    passivePerception.textContent = passiveWis;
    preview.passWis.textContent = passiveWis;

    // 10. –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ (–±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è)
    const savesHtml = `
      <li>–°–∏–ª–∞: ${formatMod(mods.str)}</li>
      <li>–õ–æ–≤–∫–æ—Å—Ç—å: ${formatMod(mods.dex)}</li>
      <li>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ: ${formatMod(mods.con)}</li>
      <li>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: ${formatMod(mods.int)}</li>
      <li>–ú—É–¥—Ä–æ—Å—Ç—å: ${formatMod(mods.wis)}</li>
      <li>–•–∞—Ä–∏–∑–º–∞: ${formatMod(mods.cha)}</li>
    `;
    preview.savesList.innerHTML = savesHtml;

    // 11. –ù–∞–≤—ã–∫–∏ (—Å —É—á–µ—Ç–æ–º –±–æ–Ω—É—Å–∞ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞)
    const skillsData = [
      { id: 'acrobatics', stat: 'dex', name: '–ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞' },
      { id: 'animal-handling', stat: 'wis', name: '–£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏' },
      { id: 'arcana', stat: 'int', name: '–ú–∞–≥–∏—è' },
      { id: 'athletics', stat: 'str', name: '–ê—Ç–ª–µ—Ç–∏–∫–∞' },
      { id: 'deception', stat: 'cha', name: '–û–±–º–∞–Ω' },
      { id: 'history', stat: 'int', name: '–ò—Å—Ç–æ—Ä–∏—è' },
      { id: 'insight', stat: 'wis', name: '–ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å' },
      { id: 'intimidation', stat: 'cha', name: '–ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ' },
      { id: 'investigation', stat: 'int', name: '–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ' },
      { id: 'medicine', stat: 'wis', name: '–ú–µ–¥–∏—Ü–∏–Ω–∞' },
      { id: 'nature', stat: 'int', name: '–ü—Ä–∏—Ä–æ–¥–∞' },
      { id: 'perception', stat: 'wis', name: '–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ' },
      { id: 'performance', stat: 'cha', name: '–í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ' },
      { id: 'persuasion', stat: 'cha', name: '–£–±–µ–∂–¥–µ–Ω–∏–µ' },
      { id: 'religion', stat: 'int', name: '–†–µ–ª–∏–≥–∏—è' },
      { id: 'sleight-of-hand', stat: 'dex', name: '–õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫' },
      { id: 'stealth', stat: 'dex', name: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å' },
      { id: 'survival', stat: 'wis', name: '–í—ã–∂–∏–≤–∞–Ω–∏–µ' }
    ];
    let skillsHtml = '';
    skillsData.forEach(skill => {
         const isProficient = skillCheckboxes[skill.id] && skillCheckboxes[skill.id].checked;
         const skillMod = mods[skill.stat] + (isProficient ? proficiencyBonus : 0);
         skillsHtml += `<li>${skill.name}: ${formatMod(skillMod)}</li>`;
    });
    preview.skillsList.innerHTML = skillsHtml;

    // 12. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    preview.strVal.textContent = stats.str;
    preview.dexVal.textContent = stats.dex;
    preview.conVal.textContent = stats.con;
    preview.intVal.textContent = stats.int;
    preview.wisVal.textContent = stats.wis;
    preview.chaVal.textContent = stats.cha;
    preview.strMod.textContent = formatMod(mods.str);
    preview.dexMod.textContent = formatMod(mods.dex);
    preview.conMod.textContent = formatMod(mods.con);
    preview.intMod.textContent = formatMod(mods.int);
    preview.wisMod.textContent = formatMod(mods.wis);
    preview.chaMod.textContent = formatMod(mods.cha);

    // 13. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å–≤–æ–¥–∫–µ
    preview.name.textContent = nameInput.value || "–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞";
    preview.race.textContent = raceSelect.options[raceSelect.selectedIndex].text;
    preview.class.textContent = classSelect.options[classSelect.selectedIndex].text;
    preview.level.textContent = levelInput.value;
    preview.bg.textContent = bgInput.value || "-";
    preview.align.textContent = alignSelect.value;
    preview.hp.textContent = currentHpInput.value || "0";
    preview.maxHp.textContent = maxHpInput.value || "0";
    preview.ac.textContent = ac;
    preview.speed.textContent = speed;
    preview.init.textContent = formatMod(init);
    // passiveWis —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤—ã—à–µ
  }

  // --- –°–ª—É—à–∞—Ç–µ–ª–∏ ---
  nameInput.addEventListener("input", updateAll);
  raceSelect.addEventListener("change", () => { updateSkillOwnership(); updateAll(); });
  classSelect.addEventListener("change", () => { updateSkillOwnership(); updateAll(); });
  levelInput.addEventListener("input", updateAll);
  bgInput.addEventListener("input", updateAll);
  alignSelect.addEventListener("change", updateAll);
  expInput.addEventListener("input", updateAll);
  currentHpInput.addEventListener("input", updateAll);
  maxHpInput.addEventListener("input", updateAll);
  baseSpeedInput.addEventListener("input", updateAll);
  for (let key in statsInputs) {
    statsInputs[key].addEventListener("input", updateAll);
  }
  for (let key in skillCheckboxes) {
    skillCheckboxes[key].addEventListener("change", updateAll);
  }

  avatarUpload.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (evt) => {
        summaryAvatar.src = evt.target.result;
        localStorage.setItem('dnd-avatar-temp', evt.target.result);
      };
      reader.readAsDataURL(file);
    }
  });

  // --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ---
  saveBtn.addEventListener("click", () => {
    const data = {
      name: nameInput.value,
      race: raceSelect.value,
      class: classSelect.value,
      level: levelInput.value,
      background: bgInput.value,
      alignment: alignSelect.value,
      exp: expInput.value,
      stats: {},
      combat: {
        hitDie: hitDieInput.value,
        currentHp: currentHpInput.value,
        maxHp: maxHpInput.value,
        baseSpeed: baseSpeedInput.value
      },
      skills: {},
      avatar: summaryAvatar.src
    };
    for (let key in statsInputs) {
      data.stats[key] = statsInputs[key].value;
    }
    for (let key in skillCheckboxes) {
      data.skills[key] = skillCheckboxes[key].checked;
    }
    localStorage.setItem("dnd-character", JSON.stringify(data));
    alert("‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å–æ—Ö—Ä–∞–Ω—ë–Ω!");
  });

  // --- –≠–∫—Å–ø–æ—Ä—Ç ---
  exportBtn.addEventListener("click", () => {
     const data = {
      name: nameInput.value || "–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
      race: raceSelect.options[raceSelect.selectedIndex].text,
      class: classSelect.options[classSelect.selectedIndex].text,
      level: levelInput.value,
      stats: {}
    };
    for (let key in statsInputs) {
      const value = parseInt(statsInputs[key].value);
      data.stats[key] = `${value} (${formatMod(getMod(value))})`;
    }
    let text = `=== –õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ ===\n`;
    text += `–ò–º—è: ${data.name}\n`;
    text += `–†–∞—Å–∞: ${data.race}\n`;
    text += `–ö–ª–∞—Å—Å: ${data.class}\n`;
    text += `–£—Ä–æ–≤–µ–Ω—å: ${data.level}\n`;
    text += `–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:\n`;
    for (let key in data.stats) {
      const name = {
        str: "–°–∏–ª–∞", dex: "–õ–æ–≤–∫–æ—Å—Ç—å", con: "–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ",
        int: "–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç", wis: "–ú—É–¥—Ä–æ—Å—Ç—å", cha: "–•–∞—Ä–∏–∑–º–∞"
      }[key];
      text += `- ${name}: ${data.stats[key]}\n`;
    }
    const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `${data.name.replace(/\s+/g, '_') || "–ø–µ—Ä—Å–æ–Ω–∞–∂"}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  // --- –°–±—Ä–æ—Å ---
  resetBtn.addEventListener("click", () => {
    if (confirm("üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É?")) {
      nameInput.value = "";
      raceSelect.value = "human";
      classSelect.value = "–≤–æ–∏–Ω";
      levelInput.value = "1";
      bgInput.value = "";
      alignSelect.value = "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π";
      expInput.value = "0";
      for (let key in statsInputs) {
        statsInputs[key].value = "10";
      }
      hitDieInput.value = "";
      currentHpInput.value = "";
      maxHpInput.value = "";
      baseSpeedInput.value = "30";
      for (let key in skillCheckboxes) {
        skillCheckboxes[key].checked = false;
      }
      summaryAvatar.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Crect width='120' height='120' fill='%233a2a1a'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='60' fill='%23d4af37'%3E%F0%9F%91%A4%3C/text%3E%3C/svg%3E";
      updateAll();
      updateSkillOwnership();
    }
  });

  // --- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON ---
  fetch('../../rulesdnd/data/races-classes.json') // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
      console.log("–î–∞–Ω–Ω—ã–µ races-classes.json —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:", data); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
      raceClassData = data;
      dataLoaded = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥
      updateSkillOwnership();
      updateAll(); // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Å—ë –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    })
    .catch(err => {
      console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö races-classes.json:", err);
      alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å –∏ –∫–ª–∞—Å—Å–æ–≤. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–±–æ–Ω—É—Å—ã –æ—Ç —Ä–∞—Å/–∫–ª–∞—Å—Å–æ–≤, –∫–æ—Å—Ç—å —Ö–∏—Ç–æ–≤) –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.");
      // –î–∞–∂–µ –µ—Å–ª–∏ JSON –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –≤—Å—ë —Ä–∞–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ–º updateAll –¥–ª—è –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
      updateAll();
    });

  // --- –ü–µ—Ä–≤–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ JSON –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ) ---
  // updateAll(); // –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—é–¥–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
});
  </script>
</body>
</html>
