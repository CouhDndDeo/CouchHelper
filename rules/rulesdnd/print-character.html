<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üñ®Ô∏è –ü–µ—á–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    /* === –°–¢–ò–õ–ò –î–õ–Ø –ü–ï–ß–ê–¢–ò === */
    @media print {
      body {
        margin: 0;
        padding: 0;
        font-size: 0.85em;
        background: #fff;
        color: #000;
        line-height: 1.4;
      }

      .container {
        max-width: 100%;
        margin: 0;
        padding: 10px;
        border: none;
        box-shadow: none;
      }

      header, nav, footer, .no-print {
        display: none;
      }

      .char-summary {
        border: 1px solid #000;
        padding: 15px;
        border-radius: 0;
        box-shadow: none;
        page-break-inside: avoid;
      }

      .summary-details > div {
        border-right: 1px solid #000;
      }

      .summary-stats {
        page-break-inside: avoid;
      }

      .summary-stat {
        border: 1px solid #000;
      }

      .summary-combat {
        border: 1px solid #000;
        background: #eee;
      }

      .summary-quick-info h4 {
        border-bottom: 1px solid #000;
      }

      .summary-quick-info ul {
        columns: 2;
        column-gap: 20px;
      }

      @page {
        size: A4;
        margin: 0.5cm;
      }
    }

    /* === –°–¢–ò–õ–ò –î–õ–Ø –≠–ö–†–ê–ù–ê === */
    body {
      font-family: 'Georgia', serif;
      background: #1a110a url('https://images.unsplash.com/photo-1601924650058-5d5e72c808e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80') no-repeat center;
      background-size: cover;
      color: #e0ccb6;
      line-height: 1.7;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 960px;
      margin: 20px auto;
      padding: 20px;
      background: rgba(30, 20, 10, 0.85);
      border: 2px solid #5a3b26;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
    }

    header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 1px dashed #8b6f47;
      padding-bottom: 10px;
    }

    header h1 {
      font-size: 2.5em;
      color: #d4af37;
      text-shadow: 0 0 5px #000;
    }

    nav {
      margin-bottom: 20px;
    }

    .btn-back {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 18px;
      background: #5a3b26;
      color: #d4af37;
      text-decoration: none;
      border-radius: 6px;
      border: 1px solid #8b6f47;
      font-weight: bold;
      transition: all 0.3s;
    }

    .btn-back:hover {
      background: #6b4426;
      color: #f0d98f;
      transform: scale(1.05);
    }

    .char-summary {
      background: linear-gradient(145deg, #5a3b26, #4a2e1a);
      border: 2px solid #8b6f47;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 6px 0 #3a2410, 0 6px 15px rgba(0, 0, 0, 0.5);
      text-align: center;
      margin: 20px 0;
      page-break-inside: avoid;
    }

    .avatar-container {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 2px solid #d4af37;
      overflow: hidden;
      margin: 0 auto 15px;
      background-color: #3a2410;
    }

    .avatar-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .summary-name {
      font-size: 1.8em;
      color: #f0d98f;
      margin-bottom: 10px;
    }

    .summary-details {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      font-size: 0.95em;
      margin-bottom: 20px;
    }

    .summary-details > div {
      border-right: 1px solid #8b6f47;
      padding: 0 10px;
    }

    .summary-details > div:last-child {
      border-right: none;
    }

    .summary-stats {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      margin: 20px 0;
    }

    .summary-stat {
      background: rgba(0, 0, 0, 0.3);
      padding: 12px 8px;
      border-radius: 10px;
      border: 1px solid #8b6f47;
    }

    .summary-stat-name {
      font-size: 0.8em;
      color: #b8a594;
      margin-bottom: 5px;
    }

    .summary-stat-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #f0d98f;
    }

    .summary-stat-mod {
      font-size: 1.1em;
      font-weight: bold;
      color: #d4af37;
    }

    .passive-perception {
      font-size: 0.9em;
      color: #b8a594;
      margin-top: 5px;
    }

    .summary-combat {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      font-size: 0.95em;
    }

    .summary-quick-info {
      text-align: left;
      margin-top: 20px;
      font-size: 0.9em;
    }

    .summary-quick-info h4 {
      color: #d4af37;
      border-bottom: 1px solid #8b6f47;
      padding-bottom: 3px;
      margin: 10px 0 5px;
    }

    .summary-quick-info ul {
      list-style-type: none;
      padding-left: 10px;
      margin: 0;
      columns: 2;
      column-gap: 20px;
    }

    .summary-quick-info li {
      margin-bottom: 3px;
      padding: 3px 0;
      border-bottom: 1px dotted #5a3b26;
    }

    footer {
      text-align: center;
      margin-top: 40px;
      color: #a89b8c;
      font-style: italic;
      padding-top: 20px;
      border-top: 1px dashed #5a3b26;
    }

    @media (max-width: 768px) {
      .summary-stats {
        grid-template-columns: repeat(3, 1fr);
      }

      .summary-details {
        flex-direction: column;
        align-items: center;
      }

      .summary-details > div {
        border-right: none;
        padding: 5px 0;
      }

      .summary-quick-info ul {
        columns: 1;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üñ®Ô∏è –ü–µ—á–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h1>
    </header>

    <nav>
      <a href="character-sheet.html" class="btn-back">
        <span class="arrow">‚Üê</span>
        <span class="text">–ù–∞–∑–∞–¥ –∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä—É</span>
      </a>
    </nav>

    <main>
      <div class="char-summary">
        <div class="avatar-container">
          <img id="summary-avatar" src="https://via.placeholder.com/100x100/3a2a1a/d4af37?text=üë§" alt="–ê–≤–∞—Ç–∞—Ä">
        </div>

        <div class="summary-name" id="summary-name">–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</div>

        <div class="summary-details">
          <div><strong>–†–∞—Å–∞:</strong> <span id="summary-race">—á–µ–ª–æ–≤–µ–∫</span></div>
          <div><strong>–ö–ª–∞—Å—Å:</strong> <span id="summary-class">–≤–æ–∏–Ω</span></div>
          <div><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> <span id="summary-level">1</span></div>
          <div><strong>–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è:</strong> <span id="summary-bg">-</span></div>
          <div><strong>–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ:</strong> <span id="summary-align">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</span></div>
        </div>

        <div class="summary-combat">
          <div><strong>–ö–î:</strong> <span id="summary-ac">10</span></div>
          <div><strong>–•–ü:</strong> <span id="summary-hp">0</span>/<span id="summary-max-hp">0</span></div>
          <div><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> <span id="summary-speed">30</span> —Ñ—É—Ç–æ–≤</div>
          <div><strong>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞:</strong> <span id="summary-init">+0</span></div>
        </div>

        <div class="summary-stats">
          <div class="summary-stat">
            <div class="summary-stat-name">–°–ò–õ</div>
            <div class="summary-stat-value" id="summary-str-val">10</div>
            <div class="summary-stat-mod" id="summary-str-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–õ–û–í</div>
            <div class="summary-stat-value" id="summary-dex-val">10</div>
            <div class="summary-stat-mod" id="summary-dex-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–¢–ï–õ</div>
            <div class="summary-stat-value" id="summary-con-val">10</div>
            <div class="summary-stat-mod" id="summary-con-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–ò–ù–¢</div>
            <div class="summary-stat-value" id="summary-int-val">10</div>
            <div class="summary-stat-mod" id="summary-int-mod">+0</div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–ú–î–†</div>
            <div class="summary-stat-value" id="summary-wis-val">10</div>
            <div class="summary-stat-mod" id="summary-wis-mod">+0</div>
            <div class="passive-perception">–ü–∞—Å—Å–∏–≤–Ω–æ–µ –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: <span id="summary-pass-wis">10</span></div>
          </div>
          <div class="summary-stat">
            <div class="summary-stat-name">–•–ê–†</div>
            <div class="summary-stat-value" id="summary-cha-val">10</div>
            <div class="summary-stat-mod" id="summary-cha-mod">+0</div>
          </div>
        </div>

        <div class="summary-quick-info">
          <div style="display: flex; gap: 30px; flex-wrap: wrap;">
            <div>
              <h4>–°–ø–∞—Å–±—Ä–æ—Å–∫–∏</h4>
              <ul id="summary-saves">
                <li>–°–∏–ª: +0</li>
                <li>–õ–æ–≤: +0</li>
                <li>–¢–µ–ª: +0</li>
                <li>–ò–Ω—Ç: +0</li>
                <li>–ú–¥—Ä: +0</li>
                <li>–•–∞—Ä: +0</li>
              </ul>
            </div>
            <div>
              <h4>–ù–∞–≤—ã–∫–∏</h4>
              <ul id="summary-skills">
                <li>–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ: +0</li>
                <li>–ê—Ç–ª–µ—Ç–∏–∫–∞: +0</li>
                <li>... (–≤—ã–±–µ—Ä–∏—Ç–µ –≤ —Ñ–æ—Ä–º–µ)</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–ª—è D&D 5e</p>
    </footer>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // --- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage ---
      const saved = localStorage.getItem("dnd-character");
      if (!saved) {
        alert("‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.");
        window.location.href = "character-sheet.html";
        return;
      }

      try {
        const data = JSON.parse(saved);

        // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ---
        document.getElementById("summary-name").textContent = data.name || "–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞";
        document.getElementById("summary-race").textContent = data.race || "—á–µ–ª–æ–≤–µ–∫";
        document.getElementById("summary-class").textContent = data.class || "–≤–æ–∏–Ω";
        document.getElementById("summary-level").textContent = data.level || "1";
        document.getElementById("summary-bg").textContent = data.background || "-";
        document.getElementById("summary-align").textContent = data.alignment || "–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π";
        document.getElementById("summary-hp").textContent = data.combat?.currentHp || "0";
        document.getElementById("summary-max-hp").textContent = data.combat?.maxHp || "0";
        document.getElementById("summary-speed").textContent = data.combat?.baseSpeed || "30";
        document.getElementById("summary-init").textContent = "+0"; // –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ
        document.getElementById("summary-ac").textContent = "10"; // –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ

        // --- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ ---
        const stats = data.stats || {};
        const statKeys = ["str", "dex", "con", "int", "wis", "cha"];
        statKeys.forEach(key => {
          const val = stats[key] || "10";
          const mod = Math.floor((parseInt(val) - 10) / 2);
          document.getElementById(`summary-${key}-val`).textContent = val;
          document.getElementById(`summary-${key}-mod`).textContent = mod >= 0 ? `+${mod}` : `${mod}`;
        });

        // --- –ü–∞—Å—Å–∏–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ ---
        const wisMod = Math.floor((parseInt(stats.wis || "10") - 10) / 2);
        const passiveWis = 10 + wisMod;
        document.getElementById("summary-pass-wis").textContent = passiveWis;

        // --- –°–ø–∞—Å–±—Ä–æ—Å–∫–∏ (–±–µ–∑ –≤–ª–∞–¥–µ–Ω–∏—è) ---
        const savesHtml = `
          <li>–°–∏–ª: ${formatMod(getMod(stats.str || "10"))}</li>
          <li>–õ–æ–≤: ${formatMod(getMod(stats.dex || "10"))}</li>
          <li>–¢–µ–ª: ${formatMod(getMod(stats.con || "10"))}</li>
          <li>–ò–Ω—Ç: ${formatMod(getMod(stats.int || "10"))}</li>
          <li>–ú–¥—Ä: ${formatMod(getMod(stats.wis || "10"))}</li>
          <li>–•–∞—Ä: ${formatMod(getMod(stats.cha || "10"))}</li>
        `;
        document.getElementById("summary-saves").innerHTML = savesHtml;

        // --- –ù–∞–≤—ã–∫–∏ (–±–µ–∑ –±–æ–Ω—É—Å–∞ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞) ---
        const skillsData = [
          { id: 'acrobatics', stat: 'dex', name: '–ê–∫—Ä–æ–±–∞—Ç–∏–∫–∞' },
          { id: 'animal-handling', stat: 'wis', name: '–£—Ö–æ–¥ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏' },
          { id: 'arcana', stat: 'int', name: '–ú–∞–≥–∏—è' },
          { id: 'athletics', stat: 'str', name: '–ê—Ç–ª–µ—Ç–∏–∫–∞' },
          { id: 'deception', stat: 'cha', name: '–û–±–º–∞–Ω' },
          { id: 'history', stat: 'int', name: '–ò—Å—Ç–æ—Ä–∏—è' },
          { id: 'insight', stat: 'wis', name: '–ü—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å' },
          { id: 'intimidation', stat: 'cha', name: '–ó–∞–ø—É–≥–∏–≤–∞–Ω–∏–µ' },
          { id: 'investigation', stat: 'int', name: '–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ' },
          { id: 'medicine', stat: 'wis', name: '–ú–µ–¥–∏—Ü–∏–Ω–∞' },
          { id: 'nature', stat: 'int', name: '–ü—Ä–∏—Ä–æ–¥–∞' },
          { id: 'perception', stat: 'wis', name: '–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ' },
          { id: 'performance', stat: 'cha', name: '–í—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ' },
          { id: 'persuasion', stat: 'cha', name: '–£–±–µ–∂–¥–µ–Ω–∏–µ' },
          { id: 'religion', stat: 'int', name: '–†–µ–ª–∏–≥–∏—è' },
          { id: 'sleight-of-hand', stat: 'dex', name: '–õ–æ–≤–∫–æ—Å—Ç—å —Ä—É–∫' },
          { id: 'stealth', stat: 'dex', name: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å' },
          { id: 'survival', stat: 'wis', name: '–í—ã–∂–∏–≤–∞–Ω–∏–µ' }
        ];

        let skillsHtml = '';
        skillsData.forEach(skill => {
             const mod = getMod(stats[skill.stat] || "10");
             skillsHtml += `<li>${skill.name}: ${formatMod(mod)}</li>`;
        });
        document.getElementById("summary-skills").innerHTML = skillsHtml;

        // --- –ê–≤–∞—Ç–∞—Ä ---
        if (data.avatar) {
          document.getElementById("summary-avatar").src = data.avatar;
        }

        // --- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---
        function getMod(value) {
          return Math.floor((parseInt(value) - 10) / 2);
        }

        function formatMod(mod) {
          return mod >= 0 ? `+${mod}` : `${mod}`;
        }

        console.log("‚úÖ –ü–µ—á–∞—Ç–Ω—ã–π –ª–∏—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω");
      } catch (e) {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:", e);
        alert("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.");
        window.location.href = "character-sheet.html";
      }
    });
  </script>
</body>
</html>
